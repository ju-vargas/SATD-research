----- MÁQUINA DE ESTADOS SHIFT BUFFER ----- 
//o buffer pode receber sinal de load e de shift 
//load para, mas shift faz sempre (que estiver ligado)

    in: 
        reset
        vertical    (é o sinal de enable da HT vertical
                     ele vai ter duas utilidades) 
        end        
        
        //como depois do end vem o disable, nao tem risco de recomeçar
        //e quando tiver enable de novo, nao vai precisar resetar (possivelmente)
         

    out: // 

    regs: 
        STATE
        REG_LOAD_BUFFER
        REG_SHIFT_BUFFER



    if (reset):
        REG_LOAD_BUFFER  <= 0
        REG_SHIFT_BUFFER <= 0
        STATE            <= state_0

    else:
        case(STATE):
            state_0:
                -- output --                
                REG_LOAD_BUFFER  <= not(REG_LOAD_BUFFER) 
                REG_SHIFT_BUFFER <= not(REG_SHIFT_BUFFER)
        
                -- transition --
                //state_0 -> state_1
                STATE <= state_1

            state_1:    
                -- output --     
                if(vertical):
                    REG_LOAD_BUFFER <= not(REG_LOAD_BUFFER)

                else:      
                    //continua como ta                                
        
                -- transition --
                if(vertical):
                    //state_1 -> state_2
                    STATE <= state_2

                else:
                    //continua nesse estado
                    STATE <= state_1
                
            state_2:
                -- output -- 
                if(end):                
                    REG_SHIFT_BUFFER <= not(REG_SHIFT_BUFFER) 
                    
                else: 
                    //continua como ta
                
                -- transition --

                if(end):
                    //state_2 -> state_0
                    STATE <= state_0

                else:
                    //continua como ta
                    STATE <= state_2
           
               

               

